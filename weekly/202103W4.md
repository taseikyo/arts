> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2021-03-21 - 2021-03-27

# Weekly #21

[readme](../README.md) | [previous](202103W3.md) | [next](202103W5.md)

## Table of Contents

- [algorithm](#algorithm-)
- [review](#review-)
	- 使用 pandoc 将 latex 转化为 docx
- [tip](#tip-)
	- 将右键开始菜单的 CMD 换成 PowerShell
	- Windows Terminal 以管理员身份打开 PowerShell
- [share](#share-)

## algorithm [⬆](#weekly-21)

## review [⬆](#weekly-21)

### 1. [使用 pandoc 将 latex 转化为 docx](https://medium.com/@zhelinchen91/how-to-convert-from-latex-to-ms-word-with-pandoc-f2045a762293)

1、基本转换

```Bash
pandoc mydoc.tex -o mydoc.docx
```

2、包含引用（bib）

```Bash
pandoc mydoc.tex --bibliography=myref.bib -o mydoc.docx
```

3、Word 样式

```Bash
pandoc mydoc.tex --bibliography=myref.bib --reference-docx=IEEE_template.doc -o mydoc.docx
```

4、交叉引用

`pandoc-crossref` 来自：[lierdakil/pandoc-crossref](https://github.com/lierdakil/pandoc-crossref)

```Bash
pandoc mydoc.tex --filter pandoc-crossref --bibliography=myref.bib --reference-docx=IEEE_template.doc -o mydoc.docx
```

转化之后还是格式怪怪的。

## tip [⬆](#weekly-21)

### 1. 将右键开始菜单的 CMD 换成 PowerShell

CMD 是真的辣鸡，既不能记录历史命令，又没什么快捷键，虽然 PowerShell 也很辣鸡，但总比 CMD 强。

一般来说右键开始菜单弹出来的是 "命令提示符(C)" & "命令提示符(管理员)(A)"，但是可以改成 PowerShell，步骤是："设置" - "个性化" - "任务栏" - "当我右键点击开始或按 下 Win 键 + X 键时，在 Windows 中将命令提示符换为 PowerShell" 勾选，然后就成 PowerShell 了。

### 2. Windows Terminal 以管理员身份打开 PowerShell

1、安装 [gsudo](https://github.com/gerardog/gsudo)

根据官方给出的安装指令，贴到 PowerShell 里面即可

```PowerShell
PowerShell -Command "Set-ExecutionPolicy RemoteSigned -scope Process; iwr -useb https://raw.githubusercontent.com/gerardog/gsudo/master/installgsudo.ps1 | iex"
```

2、进入 terminal 配置文件，新增下列配置项

```Json
{
	"guid": "{41dd7a51-f0e1-4420-a2ec-1a7130b7e950}",
	"name": "Windows PowerShell Elevated",
	"commandline": "gsudo.exe powershell.exe",
	"hidden": false,
	"colorScheme": "Dracula",
	"fontFace": "Fira Code",
	"icon" : "https://i.imgur.com/Giuj3FT.png"
},
```

3、出现 bug：error 0x80070002 when launching `gsudo.exe powershell.exe`

根据下面第三条参考链接，将 "%systemroot%\System32\WindowsPowerShell\v1.0" 贴到 PATH 环境变量即可

然后只需要新建对应 tab 页即可，就可以新建一个管理员模式的 PowerShell 了。

我将配置同步更新到 [taseikyo/oh-my-terminal](https://github.com/taseikyo/oh-my-terminal) 了，可以直接去复制配置。

参考：

- [Windows Terminal 以管理员身份打开](https://blog.csdn.net/weixin_40263993/article/details/112917070)
- [A Sudo for Windows - run elevated without spawning a new Console Host Window](https://github.com/gerardog/gsudo)
- [error 0x80070002 when launching `powershell.exe`](https://github.com/microsoft/terminal/issues/6039)

## share [⬆](#weekly-21)

[readme](../README.md) | [previous](202103W3.md) | [next](202103W5.md)
