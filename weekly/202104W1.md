> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2021-04-04 - 2021-04-10

# Weekly #23

[readme](../README.md) | [previous](202103W5.md) | [next](202104W2.md)

## Table of Contents

- [algorithm](#algorithm-)
- [review](#review-)
    - æˆ‘æ˜¯å¦‚ä½•ç”¨ Python è®¡ç®—ç¬¬ 100 ä¸‡ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—çš„
    - å¦‚ä½•ä½¿ç”¨ Python è¿›è¡Œè´¢åŠ¡è®¡ç®—
- [tip](#tip-)
	- äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ scoopï¼ˆWindowsï¼‰
	- å¸¸è§çš„ç¯å¢ƒå˜é‡ï¼ˆWindowsï¼‰
	- sublime ä¸­çš„å¿«æ·é”®æ–‡ä»¶é™å®š
- [share](#share-)

## algorithm [ğŸ”](#weekly-23)

## review [ğŸ”](#weekly-23)

### [1. æˆ‘æ˜¯å¦‚ä½•ç”¨ Python è®¡ç®—ç¬¬ 100 ä¸‡ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—çš„](https://kushm.medium.com/how-i-calculated-the-1-000-000th-fibonacci-number-with-python-e921d3642dbf)

æ–æ³¢é‚£å¥‘æ•°åˆ—æ˜¯ä¸€ä¸ªè¢«åšçƒ‚çš„é¢˜ç›®ï¼Œé€’å½’æˆ–è€…è¿­ä»£ï¼Œæˆ‘ç‚¹è¿›è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯çœ‹åˆ° 100w è¿™ä¸ªæ•°ï¼Œæƒ³ç€æ˜¯å¦æœ‰ä»€ä¹ˆç®€å•æ–¹æ³•è®¡ç®—å¾—åˆ°ã€‚

ä½œè€…æå‡ºäº”ç§æ–¹æ³•ï¼š

1. ç®€å•é€’å½’
2. å¸¦ç¼“å­˜çš„é€’å½’
3. è¿­ä»£
4. ä½¿ç”¨ Binet å…¬å¼
5. è®¡ç®—ç¬¬ 100w ä¸ªæ•°

1ã€ç®€å•é€’å½’è‚¯å®šæ˜¯ä¸å¯è¡Œçš„ï¼Œä¸ç”¨æƒ³éƒ½çŸ¥é“ï¼š

```Python
def recursiveFib(n):
    if n == 1 or n == 2:
        return 1

    return recursiveFib(n - 1) + recursiveFib(n - 2)
```

2ã€å¸¦ç¼“å­˜çš„é€’å½’ï¼Œä½œè€…ä½¿ç”¨é‡ lru_cacheï¼š

```Python
from functools import lru_cache

@lru_cache()
def recursiveFibCached(n):
    if n == 1 or n == 2:
        return 1

    return recursiveFibCached(n - 1) + recursiveFibCached (n - 2)
```

åœ¨è®¡ç®—ç¬¬ 500 ä¸ªæ—¶ï¼Œä¼šæŠ¥é”™ï¼š"RecursionError: maximum recursion depth exceeded in comparison"

éœ€è¦è®¾ç½®é€’å½’é™åˆ¶ï¼š`sys.setrecursionlimit(5000)`

ç„¶è€Œåœ¨è®¡ç®—ç¬¬1553ä¸ªæ•°å­—ï¼Œå³ä½¿é€’å½’é™åˆ¶å¢åŠ äº†ï¼Œä¹Ÿä¸ä¼šå‘ç”Ÿä»»ä½•äº‹æƒ…ï¼Œä¸ä¼šæœ‰ä»»ä½•ä¸œè¥¿æ‰“å°å‡ºæ¥åˆ°ç»ˆç«¯ï¼Œç¨‹åºåªæ˜¯ç®€å•åœ°é€€å‡ºã€‚

æ˜¾ç„¶ï¼Œæ­¤æ–¹æ³•ä¹Ÿè¡Œä¸é€šã€‚

3ã€è¿­ä»£æ³•ï¼š

```Python
def iterativeFib(n):
    a, b = 0, 1

    for i in range(n):
        a, b = b, a + b

    return a
```

è¿­ä»£å¾ˆå¿«ï¼Œåªéœ€è¦ 0.0028195 ç§’å°±å¯ä»¥è®¡ç®—å‡ºç¬¬ 10,000 ä¸ªæ•°å­—

4ã€Binet å…¬å¼ï¼š

$ F_n = \frac{\varphi^n - (-\varphi)^{-n}}{\sqrt{5}} $ï¼Œå…¶ä¸­ $ \varphi=\frac{1+\sqrt{5}}{2} $


```Python
def formulaFib(n):
    root_5 = 5 ** 0.5
    phi = ((1 + root_5) / 2)

    a = ((phi ** n) - ((-phi) ** -n)) / root_5

    return round(a)
```

è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬è¯•å›¾è®¡ç®—ä»»ä½•è¶…è¿‡1475çš„æ•°å­—ï¼Œæˆ‘ä»¬å°†ä¼šé‡åˆ°ä¸€ä¸ªé”™è¯¯ï¼š"OverflowError: (34, result too large)"

è¿™æ˜¯ç”±äºåœ¨ python ä¸­å®ç°æµ®ç‚¹æ•°çš„æ–¹å¼ï¼Œå¹¶ä¸”æµ®ç‚¹æ•°åªèƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„æœ€å¤§å€¼ï¼Œè€Œä½¿ç”¨è¿™ç§æ–¹æ³•æ—¶ï¼Œæµ®ç‚¹æ•°çš„æœ€å¤§å€¼è¶…è¿‡äº†è¿™ä¸ªå€¼

ä¿®å¤è¿™ä¸ªé—®é¢˜æ˜¯éå¸¸å®¹æ˜“å®ç°çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå†…ç½®çš„å«åš Decimal çš„æ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªåè¿›åˆ¶å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç²¾åº¦å’Œå¤§å°è¦é«˜å¾—å¤šï¼š

```Python
import decimal

def formulaFibWithDecimal(n):
    decimal.getcontext().prec = 10000

    root_5 = decimal.Decimal(5).sqrt()
    phi = ((1 + root_5) / 2)

    a = ((phi ** n) - ((-phi) ** -n)) / root_5

    return round(a)
```

åœ¨è¿™ä¸ªæ–°å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°†ç²¾åº¦å€¼è®¾ç½®ä¸º 10,000 ä½é•¿ï¼Œç„¶åå°† $ \sqrt{5} $ è½¬æ¢ä¸ºåè¿›åˆ¶å¯¹è±¡å€¼ï¼Œå¹¶åœ¨æ–¹ç¨‹ä¸­ä½¿ç”¨è¿™ä¸ªå€¼ã€‚è¿™ä½¿æˆ‘ä»¬åªéœ€ 0.0692986 ç§’è®¡ç®—å‡ºåºåˆ—ä¸­çš„ç¬¬ 10w ä¸ªæ•°

5ã€è®¡ç®—ç¬¬ 100w ä¸ªæ•°å­—

å½“ n = 10,000 æ—¶ï¼Œä½¿ç”¨å…¬å¼çš„é€Ÿåº¦æ¯”è¿­ä»£è§£è¦æ…¢ï¼Œå› ä¸ºåœ¨å…¬å¼ä¸­æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª Decimal å¯¹è±¡å¹¶åœ¨æ–¹ç¨‹ä¸­ä½¿ç”¨å®ƒï¼Œè¿™æ¯”å¾ªç¯ä¸€æ¡ç®€å•çš„æŒ‡ä»¤ 10,000 æ¬¡è¦èŠ±è´¹æ›´å¤šçš„æ—¶é—´

å¦‚æœæˆ‘ä»¬å¢åŠ éœ€è¦å¾ªç¯çš„æ¬¡æ•°ï¼Œè¿™ä¼šå¤§å¤§å¢åŠ æ•´ä¸ªæµç¨‹å®Œæˆæ‰€éœ€çš„æ—¶é—´ã€‚åœ¨æŸä¸€ç‚¹ä¸Šï¼Œå½“ n è¿‘ä¼¼ä¸º 89200 æ—¶ï¼Œè¿­ä»£è§£è®¡ç®—ç­”æ¡ˆæ‰€éœ€çš„æ—¶é—´ç­‰äºå…¬å¼ï¼Œå½“ n å¢åŠ åˆ°è¿™ä¸ªå€¼ä»¥ä¸Šæ—¶ï¼Œè¿­ä»£è§£æ‰€éœ€çš„æ—¶é—´æ¯”ä½¿ç”¨å…¬å¼æ‰€éœ€çš„æ—¶é—´å¢åŠ å¾—æ›´å¿«ï¼š

![](../images/2021/04/1_tVDfAJHWkZ8Yh31ZpWCTdg.png)

ä¸ºäº†æ­£ç¡®è®¡ç®—ç»“æœï¼Œè¿˜éœ€è¦åšä¸€ä¸ªé¢å¤–çš„æ›´æ”¹ï¼Œæé«˜ Decimal å¯¹è±¡çš„ç²¾åº¦ï¼š`decimal.getcontext().prec = 300000`

è®¡ç®—èŠ±è´¹æ—¶é—´ï¼š

- è¿­ä»£ï¼š8.832661
- å…¬å¼ï¼š1.151380

è‡³äºé‚£ä¸ªæ•°å­—ï¼šIf you wanted to see the actual number, it is 208,988 digits long and takes 209KB to store in a text file. -> [fix.txt](https://gist.github.com/1Blademaster/3560093050fff94597dc93645b6bfa4c/raw/e18dc4f0660a1694348446b2aceb9f6976a63103/fib.txt)

æŒºæœ‰è¶£çš„ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘æ¯”è¾ƒå¥½å¥‡ä»–é‚£å¼ å›¾æ€ä¹ˆå¾—æ¥çš„ï¼Œæœ€åä½œè€…è¯´ï¼Œé€šè¿‡å›¾å¯ä»¥ä¼°ç®—å‡ºä½¿ç”¨å…¬å¼è®¡ç®—ç¬¬ 10 äº¿éœ€è¦ 310.8467 ç§’ã€‚

### 2. [å¦‚ä½•ä½¿ç”¨ Python è¿›è¡Œè´¢åŠ¡è®¡ç®—](https://python.plainenglish.io/how-to-use-python-for-financial-calculations-8fd5a692a506)

è¯´æ˜¯è´¢åŠ¡è®¡ç®—ï¼Œå…¶å®æ˜¯èƒ½å€Ÿå¤šå°‘ã€æ¯æœˆéœ€è¦è¿˜å¤šå°‘ï¼ˆHow much you can borrow? What will your loan payment be?ï¼‰ï¼Œä¸»è¦ä½¿ç”¨äº† numpy_financial è¿™ä¸ªåº“ã€‚

èƒ½å€Ÿå¤šå°‘è¿˜å¤šå°‘è·Ÿä½ å€Ÿçš„æœ¬é‡‘ã€åˆ©ç‡ã€å†³å®šå¿è¿˜çš„å¹´é™è¿˜æœ‰è‡ªå·±çš„æ”¶å…¥æœ‰å…³ï¼Œå°†ç›¸å…³å‚æ•°è®¾ç½®å¥½ï¼Œå…¶ä»–éƒ½æ˜¯ numpy_financial çš„å·¥ä½œï¼Œç”±äºå¾ˆå¤šä¸œè¥¿éƒ½æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œç»“æœåªèƒ½è¯´åšä¸ªå‚è€ƒï¼Œæ„Ÿè§‰æ²¡å•¥æ„ä¹‰ã€‚

## tip [ğŸ”](#weekly-23)

### 1. äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ scoopï¼ˆWindowsï¼‰

ä»¥å‰æˆ‘å•çŸ¥é“ [scoop](github.com/lukesampson/scoop) å¥½ç”¨ï¼Œæ²¡æƒ³åˆ°å®ƒè¿™ä¹ˆå¥½ç”¨ï¼

ä¹‹å‰æˆ‘åªæ˜¯ç”¨å®ƒæ¥å®‰è£… 7zipã€aria2ã€gccã€python å’Œ latexï¼Œç›´åˆ°æœ€è¿‘æˆ‘æ‰å‘ç°æˆ‘ä½ä¼°ä»–äº†ã€‚

å› ä¸ºä¹‹å‰çœ‹åˆ°å®ƒä»‹ç»è¯´æ˜¯åªèƒ½å®‰è£…å‘½ä»¤è¡Œå·¥å…·ï¼ˆé GUIï¼‰ï¼Œåæ¥å‘ç°æˆ‘å¤©çœŸäº†ï¼Œå…¶å®æ˜¯ main è¿™ä¸ª bucket ä»…å›Šæ‹¬å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒæœ‰è‡ªå·±çš„ [æ”¶å½•æ ‡å‡†](github.com/lukesampson/scoop/wiki/Criteria-for-including-apps-in-the-main-bucket)ï¼Œåœ¨ extras è¿™ä¸ª bucket ä¸­æ”¶é›†äº†å¾ˆå¤š GUI è½¯ä»¶ï¼Œæœ€è¿‘åœ¨æŠŠè‡ªå·±ç”µè„‘ä¸Šçš„è½¯ä»¶éƒ½é‡æ–°ç”¨ scoop å®‰è£…äº†ï¼ˆèƒ½ç”¨ `scoop search x` æ‰¾åˆ°çš„ï¼‰ï¼Œå¯¹äºå¼ºè¿«ç—‡å’Œæç®€ä¸»ä¹‰çš„äººæ¥è¯´ï¼ŒçœŸæ˜¯å¤ªçˆ½äº†ï¼

å®‰è£…ï¼ˆ`scoop install x`ï¼‰ã€å‡çº§ï¼ˆ`scoop update x`ï¼‰ã€å¸è½½ï¼ˆ`scoop uninstall x`ï¼‰å’Œæ¸…ç†æ—§ç‰ˆæœ¬ï¼ˆ`scoop install *`ï¼‰éƒ½å¾ˆæ–¹ä¾¿ã€‚

å¾ˆå¤šæˆ‘å¸¸ç”¨çš„è½¯ä»¶éƒ½è¿ç§»è¿‡å»äº†ï¼Œåƒ cmderã€SumatraPDFã€Typoraã€ScreenToGif ç­‰ç­‰ã€‚

![](../images/2021/04/Snipaste_2021-04-04_22-25-04.png)

ä¸€ä¸ªæ³¨æ„ç‚¹æ˜¯ï¼Œåœ¨å®‰è£… scoop ä¹‹å‰è®°å¾—ä¿®æ”¹å®‰è£…è·¯å¾„ï¼Œä¸ç„¶ä¼šéƒ½ç»™ä½ å®‰è£…åˆ° C ç›˜ï¼Œé‚£æˆ‘ä¸èƒ½å¿ã€‚

```Bash
$env:SCOOP='D:\Programs\scoop'
[Environment]::SetEnvironmentVariable('SCOOP', $env:SCOOP, 'User')
$env:SCOOP_GLOBAL='D:\Programs\scoop'
[Environment]::SetEnvironmentVariable('SCOOP_GLOBAL', $env:SCOOP_GLOBAL, 'Machine')
```

### 2. å¸¸è§çš„ç¯å¢ƒå˜é‡ï¼ˆWindowsï¼‰

- https://blog.csdn.net/catshitone/article/details/70238163

|            VAR            |                 PATH                |
|---------------------------|-------------------------------------|
| %USERPROFILE%             | C:\Users\ç”¨æˆ·å                     |
| %HOMEPATH%                | C:\Users\ç”¨æˆ·å                     |
| %APPDATA%                 | C:\Users\ç”¨æˆ·å\AppData\Roaming     |
| %LOCALAPPDATA%            | C:\Users\ç”¨æˆ·å\AppData\Local       |
| %TEMP%                    | C:\Users\ç”¨æˆ·å\AppData\Local\Temp  |
| %TMP%                     | C:\Users\ç”¨æˆ·å\AppData\Local\Temp  |
| %SystemRoot%              | C:\Windows                          |
| %WINDIR%                  | C:\Windows                          |
| %ALLUSERSPROFILE%         | C:\ProgramData                      |
| %COMMONPROGRAMFILES%      | C:\Program Files\Common Files       |
| %COMMONPROGRAMFILES(x86)% | C:\Program Files (x86)\Common Files |
| %COMSPEC%                 | C:\Windows\System32\cmd.exe         |
| %HOMEDRIVE%               | C:\                                 |
| %SystemDrive%             | C:\                                 |
| %PROGRAMDATA%             | C:\ProgramData                      |
| %PROGRAMFILES%            | C:\Program Files                    |
| %PROGRAMFILES(X86)%       | C:\Program Files (x86)              |
| %PUBLIC%                  | C:\Users\Public                     |

ä¸Šé¢åˆ—äº†ä¸€å †ï¼Œæ„Ÿè§‰å¸¸ç”¨çš„å¯èƒ½å°± `%USERPROFILE%` å’Œ `%APPDATA%` è¿™ä¿©äº†ã€‚

### 3. sublime ä¸­çš„å¿«æ·é”®æ–‡ä»¶é™å®š

ä»Šå¤©ï¼ˆ21/04/08ï¼‰åœ¨ç”¨ [sublime-markdown-helper](https://github.com/taseikyo/sublime-markdown-helper) æ’ä»¶æ—¶å‘ç°æ˜¨å¤©çš„ä¿®æ”¹å¯¼è‡´ä»Šå¤©çš„é—®é¢˜ã€‚

ä¹‹å‰ä»…ä»…æ˜¯ <kbd>Ctrl + 1</kbd> ~ <kbd>Ctrl + 7</kbd>ï¼Œä¹Ÿå°±æ˜¯ä¸‰çº§æ ‡é¢˜ã€åˆ—è¡¨ã€å—çº§ä»£ç å’Œå—çº§ LaTex å…¬å¼ï¼Œæ˜¨å¤©åŠ äº†å¾ˆå¤šï¼Œè¡Œçº§ä»£ç å’Œå…¬å¼ã€äººç‰©åˆ—è¡¨ã€åŠ ç²—ã€æ–œä½“ã€åˆ é™¤çº¿å’Œå›¾ç‰‡ã€‚ç”±äºå°†åŠ ç²—çš„å¿«æ·é”®è®¾ç½®ä¸º <kbd>Ctrl + B</kbd> å¯¼è‡´ Python æ–‡ä»¶çš„è¿è¡Œå¿«æ·é”®è¢«å ç”¨ï¼Œä½¿å¾—æˆ‘æ— æ³•ä½¿ç”¨ï¼Œäºæ˜¯æƒ³ç€å°†æ­¤æ’ä»¶çš„ä½œç”¨é™å®šåœ¨ Markdown æ–‡ä»¶ä¸­ï¼Œç„¶åæ‰¾æ–¹æ³•ã€‚

å‚è€ƒ SublimeAStyleFormatter çš„æ–¹æ³•ï¼Œåœ¨å¿«æ·é”®è®¾ç½®ä¸­æ·»åŠ  contextï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä¸€ä¸ª keyï¼šhelper_is_enabledã€‚ç„¶ååœ¨å®ƒä»£ç é‡Œé¢å‘ç°ä¸€ä¸ª `on_query_context` å‡½æ•°ï¼Œå» API æ–‡æ¡£ä¸­æœäº†ä¸€ä¸‹å‘ç°åœ¨è§¦å‘å¿«æ·é”®æ—¶ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆé—®é¢˜ä¼¼ä¹å¯ä»¥è§£å†³äº†ï¼Œäºæ˜¯ä¿®æ”¹äº†ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œæ ¹æ®ä»¥å‰å¾—çŸ¥è·å–è§†å›¾ä¸­æ–‡ä»¶çš„è¯­è¨€ç±»å‹ï¼ˆ`syntax = view.settings().get("syntax").split("/")[-1].split(".")[0]`ï¼‰ï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯ Markdown åˆ™è¿”å› Trueï¼Œå¦åˆ™ Falseã€‚

ç„¶è€Œåœ¨ç¦»æˆåŠŸåªæœ‰ 1% çš„æ—¶å€™å‘ç”Ÿç¿»è½¦ï¼Œæˆ‘ä¸€ç›´åœ¨ç”¨ `lower(syntax)`ï¼Œæ­»æ´»ä¸èµ·ä½œç”¨ï¼Œåæ¥è°ƒå‡ºæ§åˆ¶å°å‘ç°æŠ¥é”™ä¿¡æ¯ï¼Œ`lower` å‡½æ•°ä¸å­˜åœ¨ ğŸ¤¦â€ï¼Œé©¬ä¸Šæ„è¯†åˆ°é—®é¢˜æ‰€åœ¨ã€‚ã€‚ã€‚

æœ€ç»ˆæ·»åŠ ä»£ç å¦‚ä¸‹ï¼š

```Python
PLUGIN_NAME = "MarkdownHelper"

def load_settings():
    return sublime.load_settings(PLUGIN_NAME + '.sublime-settings')


class PluginEventListener(sublime_plugin.EventListener):
    def on_query_context(self, view, key, operator, operand, match_all):
        if key == 'helper_is_enabled':
            settings = load_settings()
            allows = settings.get("allow_fileformats")
            syntax = view.settings().get("syntax").split("/")[-1].split(".")[0]
            if syntax.lower() in allows:
                return True
        return False
```

æƒ³è¦æ·»åŠ æ–‡ä»¶ç±»å‹çš„è¯ï¼Œç›´æ¥åœ¨ MarkdownHelper.sublime-settings æ–‡ä»¶ä¸­æ·»åŠ å³å¯ï¼

æœ‰ä¸ªåœ°æ–¹å¾ˆè ¢çš„æ˜¯ sublime ç”¨çš„ Python 3.3ï¼Œæ‰€ä»¥ç”¨ä¸äº† f-stringã€‚

## share [ğŸ”](#weekly-23)

[readme](../README.md) | [previous](202103W5.md) | [next](202104W2.md)
