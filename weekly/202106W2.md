> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2021-06-06 - 2021-06-12

# Weekly #32

[readme](../README.md) | [previous](202106W1.md) | [next](202106W3.md)

## Table of Contents

- [algorithm](#algorithm-)
- [review](#review-)
    - 提高 Python 技能的 10 个高级概念
- [tip](#tip-)
- [share](#share-)

## algorithm [🔝](#weekly-32)

## review [🔝](#weekly-32)

### 1. [提高 Python 技能的 10 个高级概念（Medium）](https://levelup.gitconnected.com/10-advance-python-concepts-to-level-up-your-python-skills-da3d6284ad53)

1、异常处理

我记得之前在某期提过这点，Python 中异常处理的 `try` 代码块语法如下所示：

```Python
try:
    pass
except Exception as e:
    raise
else:
    pass
finally:
    pass
```

- `try` 代码块包含需要执行的代码
- `except` 代码块包含执行失败时执行的代码
- `else` 代码块只有在 `try` 块成功执行时才执行
- `finally` 代码块总是执行，它独立于其他块

处理多个异常时，可以嵌套：

```Python
try:
   f = open('myfile.txt')
   s = f.readline()
   i = int(s.strip())
except OSError as err:
   print("OS error: {0}".format(err))
except ValueError:
   print("Could not convert data to an integer.")
except:
   print("Unexpected error:", sys.exc_info()[0])
   raise
finally:
   print("Operation Successfully Done!!")
```

2、collections 库

collections 是 Python 内置库，其目的是改进内置容器的功能

1. Counter

它接受一个可迭代对线并返回一个有序的字典，其中键是一个元素，值是出现的次数

```Python
from collections import Counter

data = [1,1,1,1,2,3,4,3,3,5,6,7,7]
count = Counter(data)
print(count)

# Counter({1: 4, 3: 3, 7: 2, 2: 1, 4: 1, 5: 1, 6: 1})
```

它有三个额外的函数：`elements()` 根据次数返回数据（迭代器的形式）；`most_common()` 返回元组列表（`[(value1, counts1), (value2, counts2)]`），其中包含按排序顺序排列的最常见元素；`subtract()` 从可迭代对象中减去对应元素

2. namedtuple

这个我用的比较多，比默认的元组多了可以命名的特点

```Python
from collections import namedtuple

Direction = namedtuple('Direction','N,S,E,W')
dt = Direction(4,74,0,0)
print(dt)

# Direction(N=4, S=74, E=0, W=0)
```

3. OrderedDict

有序字典，在最新的 Python 中，已经支持了这点

```Python
from collections import OrderedDict

dictt = OrderedDict()
dictt['a'] = 5
dictt['d'] = 2
dictt['c'] = 1
dictt['b'] = 3
print(dictt)

# OrderedDict([('a', 5), ('d', 2), ('c', 1), ('b', 3)])
```

4. defaultdict

带默认值的 `dict`，这个我也经常使用

```Python
from collections import defaultdict

dictt = defaultdict(int)
dictt['a'] = 2
print(dictt['a'])
print(dictt['b'])

# 2
# 0
```

5. deque

双向队列，可以从两边添加/删除元素

3、itertools

这个库包含了处理迭代器的各种函数，我用的实际上并不多

1. `product(iterable,iterable)`，笛卡尔积
2. `permutation(iterable)`，所有可能的排列
3. `combinations(iterable,n)`，所有可能的指定长度的组合
4. `combinations_with_replacement(iterable,n)`所有可能的指定长度的组合，可重复
5. `accumlate(iterable)`，返回累加和
6. `groupby(iterable,key=FUNC)`，返回一个具有连续键和组的迭代器


```Python
from itertools import groupby

gps = groupby([1,2, 3, 4, 5, 6, 7, 8, 9, 10], key=lambda x : x > 5)

for v, gp in gps:
    print(v, list(gp))

# False [1, 2, 3, 4, 5]
# True [6, 7, 8, 9, 10]
```

4、lambda

匿名函数，基本上扯到 Python 的高级技巧都会提到它

5、装饰器（decorator）

装饰器是 Python 中的一个特性，它在不显式修改现有代码的情况下向现有代码添加一些新功能，它有两类：函数装饰器和类装饰器

6、生成器（generator）

含 `yield` 的函数称为生成器，生成器只在请求时生成一个项，占用的内存空间也很小。

```Python
def fibon(limit):
  a,b = 0,1
  while a < limit:
      yield a
      a, b = b, a + b

for x in fibon(10):
   print (x)
```

7、多线程（threading）和多进程（multiprocessing）

you can use `threading` if your program is network bound or `multiprocessing` if it's CPU bound

8、Dunder/Magic methods

特殊方法，即前后有两个下划线的函数

```Python
num =  5
num*6
# 30

num.__mul__(6)
# 30
```

9、日志

日志是在执行时捕获代码流的过程，日志有助于轻松地调试代码

Python 有个 `logging` 库用来将日志写入文件，它一共有五个级别：

1. Debug：用于诊断具有详细信息的问题
2. Info：成功的确认
3. Warning：当意外情况发生时
4. Error：由于一个比警告更严重的问题
5. Critical：程序不能自行运行的严重错误

10、上下文管理器

主要是指 `with`语句

[Implementing a Context Manager as a Class](https://book.pythontips.com/en/latest/context_managers.html)：需要自己实现 `__enter__` 和 `__exit__` 方法：

```Python
class File(object):
    def __init__(self, file_name, method):
        self.file_obj = open(file_name, method)
    def __enter__(self):
        return self.file_obj
    def __exit__(self, type, value, traceback):
        self.file_obj.close()

with File('demo.txt', 'w') as opened_file:
    opened_file.write('Hola!')
```

## tip [🔝](#weekly-32)

## share [🔝](#weekly-32)

[readme](../README.md) | [previous](202106W1.md) | [next](202106W3.md)
