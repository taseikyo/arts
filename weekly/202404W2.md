> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2024-04-10 - 2024-04-10

# Weekly #58

[readme](../README.md) | [previous](202404W1.md) | [next](202404W3.md)

![](../images/2024/04/ulrich-mareli-aspeling-Eg7zkiPNtpU-unsplash.jpg "Weekly #58")

\**Photo by [Ulrich & Mareli Aspeling](https://unsplash.com/@marlulla) on [Unsplash](https://unsplash.com/photos/people-gathering-on-a-sunny-day-Eg7zkiPNtpU)*

> ä¸ç¼˜å¤©ä¸Šäº‘é¾™ä¼šï¼Œè°è§£æ¹˜å—ğ§‘èšŒæŒï¼Ÿ â€”â€” åˆ˜ä¸‰å¾ã€Šæ¹˜å—æ‚å’ä¸‰é¦– å…¶ä¸€ã€‹

## Table of Contents

- [algorithm](#algorithm-)
- [review](#review-)
- [tip](#tip-)
    - ç”¨ ffmpeg åˆå¹¶éŸ³é¢‘æ–‡ä»¶
- [share](#share-)

## algorithm [ğŸ”](#weekly-58)

## review [ğŸ”](#weekly-58)

### 1. [ç”¨ ffmpeg åˆå¹¶éŸ³é¢‘æ–‡ä»¶](https://www.cnblogs.com/hdu-2010/p/5791097.html)

1ã€é—®é¢˜æè¿°

æ‰“ç”µè¯çš„å¯¹è¯ï¼Œè¢«æ‹†åˆ†æˆäº†ä¸¤ä¸ª PCM æ–‡ä»¶ã€‚å…¶ä¸­ä¸»å«çš„å½•éŸ³æ–‡ä»¶ A.pcmï¼Œè¢«å«çš„å½•éŸ³ä¸º B.pcmã€‚

é—®é¢˜æ˜¯æ€ä¹ˆåˆæˆä¸€ä¸ªæ··éŸ³çš„å¯¹è¯æ–‡ä»¶ AB.wavã€‚

2ã€WAV æ–‡ä»¶çš„å½•éŸ³æ ¼å¼

å¸¸è§çš„å£°éŸ³æ–‡ä»¶ä¸»è¦æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«å¯¹åº”äºå•å£°é“ï¼ˆ11.025KHz é‡‡æ ·ç‡ã€8Bit çš„é‡‡æ ·å€¼ï¼‰å’ŒåŒå£°é“ï¼ˆ44.1KHz é‡‡æ ·ç‡ã€16Bit çš„é‡‡æ ·å€¼ï¼‰ã€‚

é‡‡æ ·ç‡æ˜¯æŒ‡ï¼šå£°éŸ³ä¿¡å·åœ¨â€œæ¨¡â†’æ•°â€è½¬æ¢è¿‡ç¨‹ä¸­å•ä½æ—¶é—´å†…é‡‡æ ·çš„æ¬¡æ•°ã€‚é‡‡æ ·å€¼æ˜¯æŒ‡æ¯ä¸€æ¬¡é‡‡æ ·å‘¨æœŸã€‚WAVE æ–‡ä»¶æ•°æ®å—åŒ…å«ä»¥è„‰å†²ç¼–ç è°ƒåˆ¶ï¼ˆPCMï¼‰æ ¼å¼è¡¨ç¤ºçš„æ ·æœ¬ã€‚WAVE æ–‡ä»¶æ˜¯ç”±æ ·æœ¬ç»„ç»‡è€Œæˆçš„ã€‚åœ¨å•å£°é“ WAVE æ–‡ä»¶ä¸­ï¼Œå£°é“0ä»£è¡¨å·¦å£°é“ï¼Œå£°é“1ä»£è¡¨å³å£°é“ã€‚åœ¨å¤šå£°é“WAVEæ–‡ä»¶ä¸­ï¼Œæ ·æœ¬æ˜¯äº¤æ›¿å‡ºç°çš„ã€‚

WAV æ–‡ä»¶çš„æ ¼å¼ï¼š

<table border="0" cellspacing="0" cellpadding="0"><colgroup><col width="103"> <col width="174"> <col width="72"> <col width="341"> <col width="253"> </colgroup><tbody><tr><td width="103" height="34">endian</td><td width="174">field name</td><td width="72">Size</td><td width="341">è¯´æ˜</td><td width="253">è®¡ç®—æ–¹å¼</td></tr><tr><td width="103" height="28">big</td><td width="174">ChunkID</td><td width="72">4</td><td width="341">æ–‡ä»¶å¤´æ ‡è¯†ï¼Œä¸€èˆ¬å°±æ˜¯ "RIFF" å››ä¸ªå­—æ¯</td><td width="253">ASCII ç è¡¨ç¤ºçš„ â€œRIFFâ€ã€‚ï¼ˆ0x52494646ï¼‰</td></tr><tr><td width="103" height="88">little</td><td width="174">ChunkSize</td><td width="72">4</td><td width="341">æ•´ä¸ªæ•°æ®æ–‡ä»¶çš„å¤§å°ï¼Œä¸åŒ…æ‹¬ä¸Šé¢ ID å’Œ Size æœ¬èº«</td><td width="253">36+SubChunk2Sizeï¼Œæˆ–æ˜¯ 4 + (8 + SubChunk1Size) + ( 8 + SubChunk2Size )ï¼Œè¿™æ˜¯æ•´ä¸ªæ•°æ®å—çš„å¤§å°ï¼ˆä¸åŒ…æ‹¬ ChunkID å’Œ ChunkSize çš„å¤§å°ï¼‰</td></tr><tr><td width="103" height="44">big</td><td width="174">Format</td><td width="72">4</td><td width="341">ä¸€èˆ¬å°±æ˜¯ "WAVE" å››ä¸ªå­—æ¯</td><td width="253">ASCII ç è¡¨ç¤ºçš„ â€œWAVEâ€ã€‚ï¼ˆ0x57415645ï¼‰</td></tr><tr><td width="103" height="66">big</td><td width="174">SubChunk1ID</td><td width="72">4</td><td width="341">æ ¼å¼è¯´æ˜å—ï¼Œæœ¬å­—æ®µä¸€èˆ¬å°±æ˜¯ "fmt"</td><td width="253">æ–°çš„æ•°æ®å—ï¼ˆæ ¼å¼ä¿¡æ¯è¯´æ˜å—ï¼‰ASCII ç è¡¨ç¤ºçš„ â€œfmtâ€â€”â€” æœ€åæ˜¯ä¸€ä¸ªç©ºæ ¼ã€‚ï¼ˆ0x666d7420ï¼‰</td></tr><tr><td width="103" height="22">little</td><td width="174">SubChunk1Size</td><td width="72">4</td><td width="341">æœ¬æ•°æ®å—çš„å¤§å°ï¼Œä¸åŒ…æ‹¬ ID å’Œ Size å­—æ®µæœ¬èº«</td><td width="253">æœ¬å—æ•°æ®çš„å¤§å°ï¼ˆå¯¹äº PCMï¼Œå€¼ä¸º 16ï¼‰ã€‚</td></tr><tr><td width="103" height="44">little</td><td width="174">AudioFormat</td><td width="72">2</td><td width="341">éŸ³é¢‘çš„æ ¼å¼è¯´æ˜</td><td width="253">PCM = 1 ï¼ˆæ¯”å¦‚ï¼Œçº¿æ€§é‡‡æ ·ï¼‰ï¼Œå¦‚æœæ˜¯å…¶å®ƒå€¼çš„è¯ï¼Œåˆ™å¯èƒ½æ˜¯ä¸€äº›å‹ç¼©å½¢å¼</td></tr><tr><td width="103" height="22">little</td><td width="174">NumChannels</td><td width="72">2</td><td width="341">å£°é“æ•°</td><td width="253">1 =&gt; å•å£°é“&nbsp; |&nbsp; 2 =&gt; åŒå£°é“</td></tr><tr><td width="103" height="22">little</td><td width="174">SampleRate</td><td width="72">4</td><td width="341">é‡‡æ ·ç‡</td><td width="253">é‡‡æ ·ç‡ï¼Œå¦‚ 8000ï¼Œ44100 ç­‰å€¼</td></tr><tr><td width="103" height="44">little</td><td width="174">ByteRate</td><td width="72">4</td><td width="341">æ¯”ç‰¹ç‡ï¼Œæ¯ç§’æ‰€éœ€è¦çš„å­—èŠ‚æ•°</td><td width="253">ç­‰äºï¼š SampleRate * numChannels * BitsPerSample / 8</td></tr><tr><td width="103" height="44">little</td><td width="174">BlockAlign</td><td width="72">2</td><td width="341">æ•°æ®å—å¯¹é½å•å…ƒ</td><td width="253">ç­‰äºï¼šNumChannels * BitsPerSample / 8</td></tr><tr><td width="103" height="44">little</td><td width="174">BitsPerSample</td><td width="72">2</td><td width="341">é‡‡æ ·æ—¶æ¨¡æ•°è½¬æ¢çš„åˆ†è¾¨ç‡</td><td width="253">é‡‡æ ·åˆ†è¾¨ç‡ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªæ ·æœ¬ç”¨å‡ ä½æ¥è¡¨ç¤ºï¼Œä¸€èˆ¬æ˜¯ 8bits æˆ–æ˜¯ 16bits</td></tr><tr><td width="103" height="44">big</td><td width="174">SubChunk2ID</td><td width="72">4</td><td width="341">çœŸæ­£çš„å£°éŸ³æ•°æ®å—ï¼Œæœ¬å­—æ®µä¸€èˆ¬æ˜¯ "data"</td><td width="253">æ–°æ•°æ®å—ï¼ŒçœŸæ­£çš„å£°éŸ³æ•°æ®ã€‚ASCII ç è¡¨ç¤ºçš„ â€œdata â€œï¼ˆ0x64617461ï¼‰&nbsp;</td></tr><tr><td width="103" height="44">little</td><td width="174">SubChunk2Size</td><td width="72">4</td><td width="341">æœ¬æ•°æ®å—çš„å¤§å°ï¼Œä¸åŒ…æ‹¬ ID å’Œ Size å­—æ®µæœ¬èº«</td><td width="253">æ•°æ®å¤§å°ï¼Œå³ï¼Œå…¶åè·Ÿç€çš„é‡‡æ ·æ•°æ®çš„å¤§å°ã€‚</td></tr><tr><td width="103" height="23">little</td><td width="174">Data</td><td width="72">N</td><td width="341">éŸ³é¢‘çš„é‡‡æ ·æ•°æ®</td><td width="253">çœŸæ­£çš„å£°éŸ³æ•°æ®</td></tr></tbody></table>

3ã€æŸ¥çœ‹å½•éŸ³çš„ PCM æ–‡ä»¶

```Bash
# pcmè½¬ç«‹ä½“å£°mp3
ffmpeg -i input1.pcm -i input2.pcm -filter_complex "amovie=input1.pcm [l]; amovie=input2.pcm [r]; [l] [r] amerge" output.mp3

# amrè½¬æ··éŸ³amr
ffmpeg -i input1.amr -i input2.amr -filter_complex amix=inputs=2:duration=longest  -ab 12.2k -ar 8000 -ac 1 output.amr

# åœ¨åé¢åŠ ä¸Š -loglevel quiet -yï¼Œ å¯ä»¥è¦†ç›–è¾“å‡ºæ–‡ä»¶ï¼Œé¿å…è¾“å‡ºæ—¥å¿—ï¼Œå¦‚ï¼š

ffmpeg -i input1.amr -i input2.amr -filter_complex amix=inputs=2:duration=longest  -ab 12.2k -ar 8000 -ac 1 output.amr -loglevel quiet -y
```

4ã€æµ‹è¯•æ•ˆæœ

4.1ã€1.amr å’Œ 2.amr æ˜¯å·¦å³å£°é“çš„å½•éŸ³ï¼Œç°åœ¨åˆæˆæ··éŸ³ 1_2.amr

```Bash
ffmpeg -i 1.amr -i 2.amr -filter_complex amix=inputs=2:duration=longest:dropout_transition=2  -ab 12.2k -ar 8000 -ac 1 1_2.amr
```

4.2ã€1.wav å’Œ 2.wav æ˜¯å·¦å³å£°é“çš„å½•éŸ³ï¼Œç°åœ¨åˆæˆç«‹ä½“å£° 1_2.mp3ï¼Œå³å·¦å£°é“æ˜¯ 1 çš„å£°éŸ³ï¼Œå³å£°é“æ˜¯ 2 çš„å£°éŸ³ã€‚

```Bash
ffmpeg -i 1.wav -i 2.wav -filter_complex "amovie=1.wav [l]; amovie=2.wav [r]; [l] [r] amerge"  1_2.mp3
```

4.3ã€åŒå£°é“çš„pcmè½¬æ¢ä¸ºå•å£°é“çš„amrï¼ŒæŒ‡å®šç¼–è§£ç å™¨

```Bash
ffmpeg -y -f s16le -ar 8000 -ac 2 -i 1.pcm -acodec amr_nb -ab 12.2k -ar 8000 -ac 1 1.amr
```

## tip [ğŸ”](#weekly-58)

## share [ğŸ”](#weekly-58)

[readme](../README.md) | [previous](202404W1.md) | [next](202404W3.md)
