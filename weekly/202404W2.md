> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2024-04-10 - 2024-04-10

# Weekly #58

[readme](../README.md) | [previous](202404W1.md) | [next](202404W3.md)

![](../images/2024/04/ulrich-mareli-aspeling-Eg7zkiPNtpU-unsplash.jpg "Weekly #58")

\**Photo by [Ulrich & Mareli Aspeling](https://unsplash.com/@marlulla) on [Unsplash](https://unsplash.com/photos/people-gathering-on-a-sunny-day-Eg7zkiPNtpU)*

> ä¸ç¼˜å¤©ä¸Šäº‘é¾™ä¼šï¼Œè°è§£æ¹˜å—ð§‘èšŒæŒï¼Ÿ â€”â€” åˆ˜ä¸‰å¾ã€Šæ¹˜å—æ‚å’ä¸‰é¦– å…¶ä¸€ã€‹

## Table of Contents

- [algorithm](#algorithm-)
- [review](#review-)
    - url çŸ­é“¾è®¾ç½®å¹¿å‘Šè¿½è¸ª cookie
- [tip](#tip-)
    - ç”¨ ffmpeg åˆå¹¶éŸ³é¢‘æ–‡ä»¶
    - å¦‚ä½•ç”Ÿæˆé”®ç›˜è¾“å…¥ç»Ÿè®¡çœ‹æ¿
- [share](#share-)
    - ä»£ç æ˜¯å¦è¶Šç®€æ´æŠ½è±¡è¶Šå¥½

## algorithm [ðŸ”](#weekly-58)

## review [ðŸ”](#weekly-58)

### 1. [url çŸ­é“¾è®¾ç½®å¹¿å‘Šè¿½è¸ª cookie](https://ylukem.com/blog/url-shorteners-set-ad-tracking-cookies)

ä½œè€…ä»‹ç»ä»–ä½¿ç”¨çŸ­é“¾çš„ç»åŽ†ï¼Œåœ¨çŸ­é“¾è¢«é‡å®šå‘åˆ°çœŸæ­£é“¾æŽ¥ä¹‹å‰ï¼Œè¢«å¹¿å‘Šå…¬å¸è®¾ç½®äº† cookieï¼Œè€Œè¿™äº› cookie èƒ½åœ¨ä½¿ç”¨å…¶å¹¿å‘ŠæŠ€æœ¯çš„æ‰€æœ‰å…¶ä»–ç½‘ç«™ä¸Šè·Ÿè¸ªï¼š

```Bash
$ curl -v https://tinyurl.com/examplezoom
...
> GET /examplezoom HTTP/2
> Host: tinyurl.com
...
< location: https://redirect.viglink.com?key=a7e37b5f6ff1de9cb410158b1013e54a&u=https%3A%2F%2Fzoom.us%2Fj%2F123456789&prodOvrd=RAC

$ curl -v 'https://redirect.viglink.com?key=a7e37b5f6ff1de9cb410158b1013e54a&u=https%3A%2F%2Fzoom.us%2Fj%2F123456789&prodOvrd=RAC'
> GET /?key=a7e37b5f6ff1de9cb410158b1013e54a&u=https%3A%2F%2Fzoom.us%2Fj%2F123456789&prodOvrd=RAC HTTP/1.1
> Host: redirect.viglink.com
...
< Set-Cookie: vglnk.PartnerRfsh.p=; Domain=.viglink.com; Path=/; SameSite=None; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Secure
< Set-Cookie: vglnk.Agent.p=v-c935c520ecc561fe60a9418874e023b7; Domain=.viglink.com; Path=/; SameSite=None; Expires=Mon, 01 Feb 2021 16:52:34 GMT; Secure
```

æžœç„¶æ˜¯åªè¦æœ‰ç›ˆåˆ©çš„åœ°æ–¹ï¼Œå°±æœ‰ç©ºå­é’»ã€‚

## tip [ðŸ”](#weekly-58)

### 1. [ç”¨ ffmpeg åˆå¹¶éŸ³é¢‘æ–‡ä»¶](https://www.cnblogs.com/hdu-2010/p/5791097.html)

1ã€é—®é¢˜æè¿°

æ‰“ç”µè¯çš„å¯¹è¯ï¼Œè¢«æ‹†åˆ†æˆäº†ä¸¤ä¸ª PCM æ–‡ä»¶ã€‚å…¶ä¸­ä¸»å«çš„å½•éŸ³æ–‡ä»¶ A.pcmï¼Œè¢«å«çš„å½•éŸ³ä¸º B.pcmã€‚

é—®é¢˜æ˜¯æ€Žä¹ˆåˆæˆä¸€ä¸ªæ··éŸ³çš„å¯¹è¯æ–‡ä»¶ AB.wavã€‚

2ã€WAV æ–‡ä»¶çš„å½•éŸ³æ ¼å¼

å¸¸è§çš„å£°éŸ³æ–‡ä»¶ä¸»è¦æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«å¯¹åº”äºŽå•å£°é“ï¼ˆ11.025KHz é‡‡æ ·çŽ‡ã€8Bit çš„é‡‡æ ·å€¼ï¼‰å’ŒåŒå£°é“ï¼ˆ44.1KHz é‡‡æ ·çŽ‡ã€16Bit çš„é‡‡æ ·å€¼ï¼‰ã€‚

é‡‡æ ·çŽ‡æ˜¯æŒ‡ï¼šå£°éŸ³ä¿¡å·åœ¨â€œæ¨¡â†’æ•°â€è½¬æ¢è¿‡ç¨‹ä¸­å•ä½æ—¶é—´å†…é‡‡æ ·çš„æ¬¡æ•°ã€‚é‡‡æ ·å€¼æ˜¯æŒ‡æ¯ä¸€æ¬¡é‡‡æ ·å‘¨æœŸã€‚WAVE æ–‡ä»¶æ•°æ®å—åŒ…å«ä»¥è„‰å†²ç¼–ç è°ƒåˆ¶ï¼ˆPCMï¼‰æ ¼å¼è¡¨ç¤ºçš„æ ·æœ¬ã€‚WAVE æ–‡ä»¶æ˜¯ç”±æ ·æœ¬ç»„ç»‡è€Œæˆçš„ã€‚åœ¨å•å£°é“ WAVE æ–‡ä»¶ä¸­ï¼Œå£°é“0ä»£è¡¨å·¦å£°é“ï¼Œå£°é“1ä»£è¡¨å³å£°é“ã€‚åœ¨å¤šå£°é“WAVEæ–‡ä»¶ä¸­ï¼Œæ ·æœ¬æ˜¯äº¤æ›¿å‡ºçŽ°çš„ã€‚

WAV æ–‡ä»¶çš„æ ¼å¼ï¼š

| endian | field name    | Size | è¯´æ˜Ž                           | è®¡ç®—æ–¹å¼                                                                                                        |
|--------|---------------|------|------------------------------|-------------------------------------------------------------------------------------------------------------|
| big    | ChunkID       | 4    | æ–‡ä»¶å¤´æ ‡è¯†ï¼Œä¸€èˆ¬å°±æ˜¯ "RIFF" å››ä¸ªå­—æ¯       | ASCII ç è¡¨ç¤ºçš„ â€œRIFFâ€ã€‚ï¼ˆ0x52494646ï¼‰                                                                              |
| little | ChunkSize     | 4    | æ•´ä¸ªæ•°æ®æ–‡ä»¶çš„å¤§å°ï¼Œä¸åŒ…æ‹¬ä¸Šé¢ ID å’Œ Size æœ¬èº« | 36+SubChunk2Sizeï¼Œæˆ–æ˜¯ 4 + (8 + SubChunk1Size) + ( 8 + SubChunk2Size )ï¼Œè¿™æ˜¯æ•´ä¸ªæ•°æ®å—çš„å¤§å°ï¼ˆä¸åŒ…æ‹¬ ChunkID å’Œ ChunkSize çš„å¤§å°ï¼‰ |
| big    | Format        | 4    | ä¸€èˆ¬å°±æ˜¯ "WAVE" å››ä¸ªå­—æ¯             | ASCII ç è¡¨ç¤ºçš„ â€œWAVEâ€ã€‚ ï¼ˆ0x57415645ï¼‰                                                                             |
| big    | SubChunk1ID   | 4    | æ ¼å¼è¯´æ˜Žå—ï¼Œæœ¬å­—æ®µä¸€èˆ¬å°±æ˜¯ "fmt"          | æ–°çš„æ•°æ®å—ï¼ˆæ ¼å¼ä¿¡æ¯è¯´ æ˜Žå—ï¼‰ASCII ç è¡¨ç¤ºçš„ â€œfmtâ€â€”â€” æœ€åŽæ˜¯ä¸€ä¸ªç©ºæ ¼ã€‚ï¼ˆ0x666d7420ï¼‰                                                      |
| little | SubChunk1Size | 4    | æœ¬æ•°æ®å—çš„å¤§å°ï¼Œä¸åŒ…æ‹¬ ID å’Œ Size å­—æ®µæœ¬èº«   | æœ¬å—æ•°æ®çš„å¤§å°ï¼ˆå¯¹äºŽ PCMï¼Œå€¼ä¸º 16ï¼‰ã€‚                                                                                      |
| little | AudioFormat   | 2    | éŸ³é¢‘çš„æ ¼å¼è¯´ æ˜Ž                     | PCM = 1 ï¼ˆæ¯”å¦‚ï¼Œçº¿æ€§é‡‡æ ·ï¼‰ï¼Œå¦‚æžœæ˜¯å…¶å®ƒå€¼çš„è¯ï¼Œåˆ™å¯èƒ½æ˜¯ä¸€äº›åŽ‹ç¼©å½¢å¼                                                                       |
| little | NumChannels   | 2    | å£°é“æ•°                          | 1 =&gt; å•å£°é“&nbsp; |&nbsp; 2 =&gt; åŒå£°é“                                                                       |
| little | SampleRate    | 4    | é‡‡æ ·çŽ‡                          | é‡‡æ ·çŽ‡ï¼Œå¦‚ 8000ï¼Œ44100 ç­‰å€¼                                                                                         |
| little | ByteRate      | 4    | æ¯”ç‰¹çŽ‡ï¼Œæ¯ç§’æ‰€éœ€è¦çš„å­—èŠ‚æ•°                | ç­‰äºŽ ï¼š SampleRate * numChannels * BitsPerSample / 8                                                           |
| little | BlockAlign    | 2    | æ•°æ®å—å¯¹é½å•å…ƒ                      | ç­‰äºŽï¼šNumChannels * BitsPerSample / 8                                                                          |
| little | BitsPerSample | 2    | é‡‡æ ·æ—¶æ¨¡æ•°è½¬æ¢çš„åˆ†è¾¨çŽ‡                  | é‡‡æ ·åˆ†è¾¨çŽ‡ ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªæ ·æœ¬ç”¨å‡ ä½æ¥è¡¨ç¤ºï¼Œä¸€èˆ¬æ˜¯ 8bits æˆ–æ˜¯ 16bits                                                                    |
| big    | SubChunk2ID   | 4    | çœŸæ­£çš„å£°éŸ³æ•°æ®å—ï¼Œæœ¬å­—æ®µä¸€èˆ¬æ˜¯ "data"       | æ–°æ•°æ®å—ï¼ŒçœŸæ­£çš„å£°éŸ³æ•°æ®ã€‚ASCII ç è¡¨ç¤ºçš„ â€œdata â€œï¼ˆ0x64617461ï¼‰&nbsp;                                                           |
| little | SubChunk2Size | 4    | æœ¬æ•°æ®å—çš„å¤§å°ï¼Œä¸åŒ…æ‹¬ ID å’Œ Size å­—æ®µæœ¬èº«   | æ•°æ®å¤§å°ï¼Œå³ï¼Œå…¶åŽè·Ÿç€çš„é‡‡æ ·æ•°æ®çš„å¤§å°ã€‚                                                                                        |
| little | Data          | N    | éŸ³é¢‘çš„é‡‡æ ·æ•°æ®                      | çœŸæ­£çš„å£°éŸ³æ•°æ®                                                                                                     |


3ã€æŸ¥çœ‹å½•éŸ³çš„ PCM æ–‡ä»¶

```Bash
# pcmè½¬ç«‹ä½“å£°mp3
ffmpeg -i input1.pcm -i input2.pcm -filter_complex "amovie=input1.pcm [l]; amovie=input2.pcm [r]; [l] [r] amerge" output.mp3

# amrè½¬æ··éŸ³amr
ffmpeg -i input1.amr -i input2.amr -filter_complex amix=inputs=2:duration=longest  -ab 12.2k -ar 8000 -ac 1 output.amr

# åœ¨åŽé¢åŠ ä¸Š -loglevel quiet -yï¼Œ å¯ä»¥è¦†ç›–è¾“å‡ºæ–‡ä»¶ï¼Œé¿å…è¾“å‡ºæ—¥å¿—ï¼Œå¦‚ï¼š

ffmpeg -i input1.amr -i input2.amr -filter_complex amix=inputs=2:duration=longest  -ab 12.2k -ar 8000 -ac 1 output.amr -loglevel quiet -y
```

4ã€æµ‹è¯•æ•ˆæžœ

4.1ã€1.amr å’Œ 2.amr æ˜¯å·¦å³å£°é“çš„å½•éŸ³ï¼ŒçŽ°åœ¨åˆæˆæ··éŸ³ 1_2.amr

```Bash
ffmpeg -i 1.amr -i 2.amr -filter_complex amix=inputs=2:duration=longest:dropout_transition=2  -ab 12.2k -ar 8000 -ac 1 1_2.amr
```

4.2ã€1.wav å’Œ 2.wav æ˜¯å·¦å³å£°é“çš„å½•éŸ³ï¼ŒçŽ°åœ¨åˆæˆç«‹ä½“å£° 1_2.mp3ï¼Œå³å·¦å£°é“æ˜¯ 1 çš„å£°éŸ³ï¼Œå³å£°é“æ˜¯ 2 çš„å£°éŸ³ã€‚

```Bash
ffmpeg -i 1.wav -i 2.wav -filter_complex "amovie=1.wav [l]; amovie=2.wav [r]; [l] [r] amerge"  1_2.mp3
```

4.3ã€åŒå£°é“çš„pcmè½¬æ¢ä¸ºå•å£°é“çš„amrï¼ŒæŒ‡å®šç¼–è§£ç å™¨

```Bash
ffmpeg -y -f s16le -ar 8000 -ac 2 -i 1.pcm -acodec amr_nb -ab 12.2k -ar 8000 -ac 1 1.amr
```

### 2. [å¦‚ä½•ç”Ÿæˆé”®ç›˜è¾“å…¥ç»Ÿè®¡çœ‹æ¿](https://greptime.com/blogs/2024-03-19-keyboard-monitoring)

å…¶å®žè¿™ä¸ªä¸œè¥¿ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯ç›‘å¬é”®ç›˜çš„è¾“å…¥å¹¶ä¿å­˜ï¼Œç„¶åŽä½¿ç”¨ä¸€ä¸ªå¯è§†åŒ–æ¡†æž¶å°†å…¶å¯è§†åŒ–å³å¯ã€‚


## share [ðŸ”](#weekly-58)

### 1. ä»£ç æ˜¯å¦è¶Šç®€æ´æŠ½è±¡è¶Šå¥½

- https://overreacted.io/goodbye-clean-code/

ä¸Šé¢çš„æ–‡ç« è®²è¿°äº†ä½œè€…çš„é‡æž„ä»£ç çš„ç»åŽ†ï¼Œå°†åŒæ—¶é‡å¤å†—ä½™çš„ä»£ç è¿›è¡Œäº†ç²¾ç®€é‡æž„ï¼Œç»“æžœä»–è€æ¿è®©ä»–æŠŠä»£ç æ”¹å›žäº†è€ç‰ˆæœ¬ã€‚è¿™é‡Œå°±å¼•å‡ºä¸€ä¸ªè¯é¢˜ï¼šä»£ç æ˜¯å¦è¶Šç®€æ´æŠ½è±¡è¶Šå¥½ï¼Ÿ

å¾ˆæ˜¾ç„¶ï¼Œå¦‚æžœæ˜¯è‡ªå·±ç»´æŠ¤çš„ä»£ç ï¼Œè‡ªå·±çŸ¥é“å…¶é€»è¾‘ï¼Œå½“ç„¶æ˜¯è¶Šç®€æ´æŠ½è±¡è¶Šå¥½çš„ï¼Œä½†æ˜¯ä½œä¸ºå…¬å¸çš„æŸä¸ªäº§å“ï¼Œä½ è¦çŸ¥é“ç»´æŠ¤è¿™ä¸ªä»£ç çš„æ˜¯ä½ ä¸Žä½ çš„åŒäº‹ï¼Œå¦‚æžœä½ é«˜åº¦ç®€æ´æŠ½è±¡ï¼Œä»£ç ç¡®å®žå‡å°‘äº†ï¼Œä½†æ˜¯ç†è§£æˆæœ¬å´å¤§å¤§æå‡äº†ï¼Œéšç€äººå‘˜å˜åŠ¨ï¼Œæ–°æ¥çš„åŒäº‹éœ€è¦åŽ»èŠ±è´¹å¾ˆå¤šæ—¶é—´åŽ»ç†è§£åŽŸæ¥çš„ä»£ç é€»è¾‘ï¼Œä»Žå…¬å¸å±‚é¢æ¥è®²ï¼Œè¿™æ˜¾ç„¶æ˜¯å¾—ä¸å¿å¤±çš„ã€‚å³ä¾¿æŸæ¬¾äº§å“èƒŒåŽæ˜¯ä¸€å †å±Žå±±ä»£ç ï¼Œä½†æ˜¯å®ƒèƒ½è·‘ï¼Œèƒ½ç»™ç”¨æˆ·æä¾›æœåŠ¡å¹¶ä¸”æœªå‡ºé”™ï¼Œå®ƒå°±æ˜¯å¥½çš„ä¸æ˜¯å—ï¼Ÿ

[readme](../README.md) | [previous](202404W1.md) | [next](202404W3.md)
