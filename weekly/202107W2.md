> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2021-07-02 - 2021-07-02

# Weekly #36

[readme](../README.md) | [previous](202107W1.md) | [next](202107W3.md)

## Table of Contents

- [algorithm](#algorithm-)
- [review](#review-)
    - CSS ä¸ CSS-in-JS çš„æ€§èƒ½æ¯”è¾ƒï¼ˆè‹±æ–‡ï¼‰
- [tip](#tip-)
- [share](#share-)

## algorithm [ğŸ”](#weekly-36)

## review [ğŸ”](#weekly-36)

### 1. [CSS ä¸ CSS-in-JS çš„æ€§èƒ½æ¯”è¾ƒï¼ˆè‹±æ–‡ï¼‰](https://pustelto.com/blog/css-vs-css-in-js-perf)

å•ç‹¬å†™ cssï¼Œå’Œåœ¨ js ä¸­å†™ css è¿™å…¶å®çœ‹ä¸ªäººä¹ æƒ¯ï¼Œæœ‰äººä¹ æƒ¯å•ç‹¬å†™ï¼ˆæ¯”å¦‚æˆ‘ï¼‰ï¼Œæœ‰äººå–œæ¬¢åœ¨ js é‡Œé¢æ§åˆ¶ï¼Œæˆ‘åŸæ¥ä»¥ä¸ºè¿™å…¶å®éƒ½å·®ä¸å¤ªå¤šï¼Œå®é™…ä¸Šå®ƒä¿©æ€§å·®å·®å¼‚è¿˜è›®å¤§çš„ã€‚

TLDR: Donâ€™t use runtime CSS-in-JS if you care about the load performance of your site. ***Simply less JS = Faster Site.***

æµ‹è¯•ï¼š

- Network (size of the JS and CSS assets, coverage, number of requests)
- Lighthouse audits (performance audit with mobile preset)
- Performance profiling (tests for page load, one for drag and drop interaction)

1ã€ç½‘ç»œæ¯”è¾ƒ

Home page network stats comparison

|                          | Styled Component |       Linaria |
|-------------------------:|-----------------:|--------------:|
| Total number of requests |               11 |            13 |
| Total size               |      361kB/1.8MB |   356kB/1.8MB |
| CSS size                 |      2.3kB/7.2kB | 14.7kB/71.5kB |
| No. of CSS requests      |                1 |             3 |
| JS size                  |      322kB/1.8MB |   305kB/1.7MB |
| No. of JS requests       |                6 |             6 |

Search page network stats comparison

|                          | Styled Component |       Linaria |
|-------------------------:|-----------------:|--------------:|
| Total number of requests |               10 |            12 |
| Total size               |      395kB/1.9MB |   391kB/1.9MB |
| CSS size                 |      2.3kB/7.2kB | 16.0kB/70.0kB |
| No. of CSS requests      |                1 |             3 |
| JS size                  |      363kB/1.9MB |   345kB/1.8MB |
| No. of JS requests       |                6 |             6 |

the sum of CSS and JS for [Linaria](https://linaria.dev) is still smaller than the size of the JS itself in Styled Component

2ã€è¦†ç›–èŒƒå›´

Coverage comparison â€“ Home page

|                    | Styled Component | Linaria |
|-------------------:|-----------------:|--------:|
| Size of unused CSS |            6.5kB |  55.6kB |
| Size of unused JS  |            932kB |   915kB |
| Total size         |           938.5k | 970.6kB |

Coverage comparison â€“ Search page

|                    | Styled Component | Linaria |
|-------------------:|-----------------:|--------:|
| Size of unused CSS |            6.3kB |  52.9kB |
| Size of unused JS  |            937kB |   912kB |
| Total size         |           938.5k | 970.6kB |

3ã€Lighthouse

![](../images/2021/07/b11aefe7-608.webp)

![](../images/2021/07/9f885a26-608.webp)

Linaria åœ¨å¤§å¤šæ•°ç½‘ç»œè¦ç´ ä¸­è¡¨ç°å¾—æ›´å¥½ï¼ˆåœ¨ CLS ä¸­ä¸¢å¤±ä¸€æ¬¡ï¼‰ã€‚æœ‰æ—¶ç”šè‡³æ˜¯å¾ˆå¤§çš„å·®è·ã€‚ä¾‹å¦‚ï¼ŒLCP åœ¨ä¸»é¡µä¸Šå¿« 870 æ¯«ç§’ï¼Œåœ¨æœç´¢é¡µé¢ä¸Šå¿« 1.2 ç§’ã€‚ä½¿ç”¨æ™®é€š CSS æ¸²æŸ“é¡µé¢ä¸ä»…è¦å¿«å¾—å¤šï¼Œè€Œä¸”è¿˜éœ€è¦æ›´å°‘çš„èµ„æºã€‚é˜»å¡æ—¶é—´å’Œæ‰§è¡Œæ‰€æœ‰ JS æ‰€éœ€çš„æ—¶é—´åˆ†åˆ«å‡å°‘äº† 300 æ¯«ç§’å’Œå¤§çº¦ 1.3 ç§’ã€‚

4ã€æ€§èƒ½åˆ†æ

![](../images/2021/07/800b6eb6-608.webp)

![](../images/2021/07/de989777-608.webp)

ä½¿ç”¨æ ·å¼åŒ–ç»„ä»¶æ„å»ºçš„å±å¹•æœ‰æ›´å¤šé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ã€‚ä¸ Linaria å˜ä½“ç›¸æ¯”ï¼Œè¿™äº›ä»»åŠ¡ä¹Ÿéœ€è¦æ›´é•¿çš„æ—¶é—´æ‰èƒ½å®Œæˆã€‚

ä¸‹é¢æ˜¯ç”¨æ ·å¼åŒ–ç»„ä»¶ï¼ˆä¸Šéƒ¨ï¼‰å’Œ Linariaï¼ˆä¸‹éƒ¨ï¼‰åŠ è½½ä¸»é¡µçš„æ€§èƒ½å›¾è¡¨çš„å¯è§†åŒ–æ¯”è¾ƒã€‚

![](../images/2021/07/3e337dc5-608.webp)

5ã€ç”¨æˆ·äº¤äº’çš„æ¯”è¾ƒ

|                     | Styled Component | Linaria |   Diff |
|--------------------:|-----------------:|--------:|-------:|
| Scripting           |             2955 |    2392 | -563ms |
| Rendering           |             3002 |    2525 | -477ms |
| Painting            |              329 |     313 |  -16ms |
| Total Blocking Time |          1862.66 |  994.07 | -868ms |

![](../images/2021/07/ba255c84-608.webp)

6ã€æ€»ç»“

è¿è¡Œæ—¶ CSS-in-JS å¯¹ç½‘é¡µæœ‰æ˜æ˜¾çš„å½±å“ã€‚ä¸»è¦ç”¨äºäº’è”ç½‘è¿æ¥è¾ƒæ…¢æˆ–æ•°æ®è¾ƒæ˜‚è´µçš„ä½ç«¯è®¾å¤‡å’Œåœ°åŒºã€‚

ä½œè€…ï¼šä¸‹æ¬¡æˆ‘å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®æ—¶ï¼Œæˆ‘å°†ä¸å†ä½¿ç”¨è¿è¡Œæ—¶ css in-jsã€‚æˆ‘è¦ä¹ˆä½¿ç”¨è€å¼çš„ CSSï¼Œè¦ä¹ˆä½¿ç”¨ä¸€äº›æ„å»ºæ—¶çš„ CSS in-JS æ›¿ä»£æ–¹æ¡ˆï¼Œä» JS åŒ…ä¸­è·å–æˆ‘çš„æ ·å¼ã€‚

## tip [ğŸ”](#weekly-36)

## share [ğŸ”](#weekly-36)

[readme](../README.md) | [previous](202107W1.md) | [next](202107W3.md)
