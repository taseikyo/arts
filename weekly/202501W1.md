> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2025-04-08 - 2025-04-08

# Weekly #95

[readme](../README.md) | [previous](202412W4.md) | [next](202412W6.md)

![](../images/2025/01/jernej-graj-ieJTmGymyIo-unsplash.jpg "Weekly #95")

\**Photo by [Jernej Graj](https://unsplash.com/@jernejgraj) on [Unsplash](https://unsplash.com/photos/woman-in-black-bikini-top-standing-on-brown-rock-during-daytime-ieJTmGymyIo)*

## Table of Contents

- [algorithm](#algorithm-)
	- 爬楼梯
- [review](#review-)
- [tip](#tip-)
	- js 实现各种复制到剪贴板
	- javascript 转颜文字
	- PyQt5监听系统粘贴板并提取时间
	- psutil 模块
- [share](#share-)

## algorithm [🔝](#weekly-95)

### 1. [70. 爬楼梯](https://leetcode.cn/problems/climbing-stairs/description/?envType=study-plan-v2&envId=top-100-liked)

#### 题目

假设你正在爬楼梯。需要 n 阶你才能到达楼顶。

每次你可以爬 1 或 2 个台阶。你有多少种不同的方法可以爬到楼顶呢？

示例 1：

输入：n = 2
输出：2
解释：有两种方法可以爬到楼顶。
1. 1 阶 + 1 阶
2. 2 阶
示例 2：

输入：n = 3
输出：3
解释：有三种方法可以爬到楼顶。
1. 1 阶 + 1 阶 + 1 阶
2. 1 阶 + 2 阶
3. 2 阶 + 1 阶

- 1 <= n <= 45

#### 解法

最直观的方法就是递归了，结果超时了，于是加了个 map 作为缓存，然后就过了：

> [70.climbing-stairs.go](../code/70.climbing-stairs.go)

```go
var cache = map[int]int{
    1: 1,
    2: 2,
}

func climbStairs(n int) int {
    if v, ok := cache[n]; ok {
        return v
    }
    cache[n] = climbStairs(n-1) + climbStairs(n-2)

    return cache[n]
}
```


## review [🔝](#weekly-95)

## tip [🔝](#weekly-95)

### 1. [js 实现各种复制到剪贴板](https://www.cnblogs.com/huijieoo/articles/5569990.html)

一、实现点击按钮，复制文本框中的的内容

```js
<script type="text/javascript">
function copyUrl2()
{
var Url2=document.getElementById("biao1");
Url2.select(); // 选择对象
document.execCommand("Copy"); // 执行浏览器复制命令
alert("已复制好，可贴粘。");
}
</script>
<textarea cols="20" rows="10" id="biao1">用户定义的代码区域</textarea>
<input type="button" onClick="copyUrl2()" value="点击复制代码" />
```

二、复制专题地址和 url 地址，传给 QQ/MSN 上的好友

```js
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>Js复制代码</title>
</head>
<body>
<p>
<input type="button" name="anniu1" onClick='copyToClipBoard()' value="复制专题地址和url地址，传给QQ/MSN上的好友">
<script language="javascript">
function copyToClipBoard(){
var clipBoardContent="";
clipBoardContent+=document.title;
clipBoardContent+="";
clipBoardContent+=this.location.href;
window.clipboardData.setData("Text",clipBoardContent);
alert("复制成功，请粘贴到你的QQ/MSN上推荐给你的好友");
}
</script>
```

三、直接复制 url

```js
<input type="button" name="anniu2" onClick='copyUrl()' value="复制URL地址">
<script language="javascript">
function copyUrl()
{
var clipBoardContent=this.location.href;
window.clipboardData.setData("Text",clipBoardContent);
alert("复制成功!");
}
</script>
```

四、点击文本框时，复制文本框里面的内容

```js
<input onclick="oCopy(this)" value="你好.要copy的内容!">
<script language="javascript">
function oCopy(obj){
obj.select();
js=obj.createTextRange();
js.execCommand("Copy")
alert("复制成功!");
}
</script>
```

五、复制文本框或者隐藏域中的内容

```js
<script language="javascript">
function CopyUrl(target){
target.value=myimg.value;
target.select();
js=myimg.createTextRange();
js.execCommand("Copy");
alert("复制成功!");
}
function AddImg(target){
target.value="[IMG]"+myimg.value+"[/ img]";
target.select();
js=target.createTextRange();
js.execCommand("Copy");
alert("复制成功!");
}
</script>
```

六、复制 span 标记中的内容

```js
<script type="text/javascript">
</script>
<br />
<br />
<script type="text/javascript">function copyText(obj)
{
var rng = document.body.createTextRange();
rng.moveToElementText(obj);
rng.scrollIntoView();
rng.select();
rng.execCommand("Copy");
rng.collapse(false);
alert("复制成功!");
}
</script>
```

七、浏览器兼容  copyToClipboard("拷贝内容")

```js
function copyToClipboard(txt) {
  if (window.clipboardData) {
    window.clipboardData.clearData();
    clipboardData.setData("Text", txt);
    alert("复制成功！");

  } else if (navigator.userAgent.indexOf("Opera") != -1) {
    window.location = txt;
  } else if (window.netscape) {
    try {
      netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
    } catch (e) {
      alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将 'signed.applets.codebase_principal_support'设置为'true'");
    }
    var clip = Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);
    if (!clip)
      return;
    var trans = Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);
    if (!trans)
      return;
    trans.addDataFlavor("text/unicode");
    var str = new Object();
    var len = new Object();
    var str = Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);
    var copytext = txt;
    str.data = copytext;
    trans.setTransferData("text/unicode", str, copytext.length * 2);
    var clipid = Components.interfaces.nsIClipboard;
    if (!clip)
      return false;
    clip.setData(trans, null, clipid.kGlobalClipboard);
    alert("复制成功！");
  }
}
```

八、兼容各大浏览器的复制代码（结合 ZeroClipboard.js）

```html
<html>
<head>
<title>Zero Clipboard Test</title>
<script type="text/javascript" src="ZeroClipboard.js"></script>
<script language="JavaScript">
 var clip = null;
 function $(id) { return document.getElementById(id); }
 function init() {
     clip = new ZeroClipboard.Client();
     clip.setHandCursor(true);    
     clip.addEventListener('mouseOver', function (client) {
  // update the text on mouse over
  clip.setText( $('fe_text').value );
     });
      
     clip.addEventListener('complete', function (client, text) {
  //debugstr("Copied text to clipboard: " + text );
  alert("该地址已经复制，你可以使用Ctrl+V 粘贴。");
     });
     clip.glue('clip_button', 'clip_container' );
 }
</script>
</head>
<body onLoad="init()">
<input id="fe_text" cols=50 rows=5 value=复制内容文本1 >
<span id="clip_container"><span id="clip_button"><b>复制</b></span></span>
</body>
</html
```

### 2. [javascript 转颜文字](https://utf-8.jp/public/aaencode.html)

### 3. [PyQt5监听系统粘贴板并提取时间](https://blog.csdn.net/yanzi1225627/article/details/76736361)

核心代码段：

```python
def addClipbordListener(self):
    clipboard = QApplication.clipboard()
    clipboard.dataChanged.connect(self.widget.onClipboradChanged)

def onClipboradChanged(self):
    clipboard = QApplication.clipboard()
    text = clipboard.text()
    ...
```

源码：[qt5-clipboard.7z](../code/qt5-clipboard.7z)

### 4. [psutil 模块](https://www.cnblogs.com/liu-yao/p/5678157.html)

1 CPU 相关

查看 cpu 信息

```python
import psutil

>>> psutil.cpu_times()
scputimes(user=11677.09, nice=57.93, system=148675.58, idle=2167147.79, iowait=260828.48, irq=7876.28, softirq=0.0, steal=3694.59, guest=0.0, guest_nice=0.0)
```

显示 cpu 所有逻辑信息

```python
>>> psutil.cpu_times(percpu=True)
[scputimes(user=11684.17, nice=57.93, system=148683.01, idle=2168982.08, iowait=260833.18, irq=7882.35, softirq=0.0, steal=3697.3, guest=0.0, guest_nice=0.0)]
```

查看用户的 cpu 时间比

```python
>>> psutil.cpu_times().user
11684.4
```

查看 cpu 逻辑个数

```python
>>> psutil.cpu_count()
1
```

查看 cpu 物理个数

```python
>>> psutil.cpu_count(logical=False)
1
```

3.2 查看系统内存

```python
>>> import psutil
>>> mem = psutil.virtual_memory()
>>> mem
#系统内存的所有信息
svmem(total=1040662528, available=175054848, percent=83.2, used=965718016, free=74944512, active=566755328, inactive=59457536, buffers=9342976, cached=90767360)
```

系统总计内存

```python
>>> mem.total
1040662528
```

系统已经使用内存

```python
>>> mem.used
965718016
```

系统空闲内存

```python
>>> mem.free
112779264
```

获取 swap 内存信息

```python
>>> psutil.swap_memory()
sswap(total=0, used=0, free=0, percent=0, sin=0, sout=0)
```

读取磁盘参数

磁盘利用率使用 psutil.disk_usage 方法获取，

磁盘 IO 信息包括 read_count(读 IO 数)，write_count(写 IO 数)  
read_bytes(IO 写字节数)，read_time(磁盘读时间)，write_time(磁盘写时间), 这些 IO 信息用

```python
psutil.disk_io_counters()
```

获取磁盘的完整信息

```python
psutil.disk_partitions()
```

获取分区表的参数

```python
psutil.disk_usage('/')   #获取/分区的状态
```

获取硬盘 IO 总个数

```python
psutil.disk_io_counters()
```

获取单个分区 IO 个数

```python
psutil.disk_io_counters(perdisk=True)    #perdisk=True参数获取单个分区IO个数
```

读取网络信息

网络信息与磁盘 IO 信息类似, 涉及到几个关键点，包括 byes_sent(发送字节数),byte_recv=xxx(接受字节数),  
pack-ets_sent=xxx(发送字节数),pack-ets_recv=xxx(接收数据包数), 这些网络信息用

获取网络总 IO 信息

```python
psutil.net_io_counters()  
```

输出网络每个接口信息

```python
psutil.net_io_counters(pernic=True)     #pernic=True
```

获取当前系统用户登录信息

```python
psutil.users()
```

获取开机时间

```python
psutil.boot_time() #以 linux 时间格式返回

datetime.datetime.fromtimestamp(psutil.boot_time ()).strftime("%Y-%m-%d %H: %M: %S") #转换成自然时间格式
```


系统进程管理  
获取当前系统的进程信息, 获取当前程序的运行状态, 包括进程的启动时间, 查看设置 CPU 亲和度, 内存使用率, IO 信息  
socket 连接, 线程数等  
获取进程信息

查看系统全部进程

```python
psutil.pids()
```

查看单个进程

```python
p = psutil.Process(2423) 
p.name()   #进程名
p.exe()    #进程的bin路径
p.cwd()    #进程的工作目录绝对路径
p.status()   #进程状态
p.create_time()  #进程创建时间
p.uids()    #进程uid信息
p.gids()    #进程的gid信息
p.cpu_times()   #进程的cpu时间信息,包括user,system两个cpu信息
p.cpu_affinity()  #get进程cpu亲和度,如果要设置cpu亲和度,将cpu号作为参考就好
p.memory_percent()  #进程内存利用率
p.memory_info()    #进程内存rss,vms信息
p.io_counters()    #进程的IO信息,包括读写IO数字及参数
p.connectios()   #返回进程列表
p.num_threads()  #进程开启的线程数
听过psutil的Popen方法启动应用程序，可以跟踪程序的相关信息
from subprocess import PIPE
p = psutil.Popen(["/usr/bin/python", "-c", "print('hello')"],stdout=PIPE)
p.name()
p.username()
```

## share [🔝](#weekly-95)

[readme](../README.md) | [previous](202412W4.md) | [next](202412W6.md)
