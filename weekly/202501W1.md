> @Author  : Lewis Tian (taseikyo@gmail.com)
>
> @Link    : github.com/taseikyo
>
> @Range   : 2025-04-08 - 2025-04-08

# Weekly #95

[readme](../README.md) | [previous](202412W4.md) | [next](202412W6.md)

![](../images/2025/01/jernej-graj-ieJTmGymyIo-unsplash.jpg "Weekly #95")

\**Photo by [Jernej Graj](https://unsplash.com/@jernejgraj) on [Unsplash](https://unsplash.com/photos/woman-in-black-bikini-top-standing-on-brown-rock-during-daytime-ieJTmGymyIo)*

## Table of Contents

- [algorithm](#algorithm-)
- [review](#review-)
- [tip](#tip-)
	- js å®ç°å„ç§å¤åˆ¶åˆ°å‰ªè´´æ¿
- [share](#share-)

## algorithm [ğŸ”](#weekly-95)

## review [ğŸ”](#weekly-95)

## tip [ğŸ”](#weekly-95)

### 1. [js å®ç°å„ç§å¤åˆ¶åˆ°å‰ªè´´æ¿](https://www.cnblogs.com/huijieoo/articles/5569990.html)

ä¸€ã€å®ç°ç‚¹å‡»æŒ‰é’®ï¼Œå¤åˆ¶æ–‡æœ¬æ¡†ä¸­çš„çš„å†…å®¹

```js
<script type="text/javascript">
function copyUrl2()
{
var Url2=document.getElementById("biao1");
Url2.select(); // é€‰æ‹©å¯¹è±¡
document.execCommand("Copy"); // æ‰§è¡Œæµè§ˆå™¨å¤åˆ¶å‘½ä»¤
alert("å·²å¤åˆ¶å¥½ï¼Œå¯è´´ç²˜ã€‚");
}
</script>
<textarea cols="20" rows="10" id="biao1">ç”¨æˆ·å®šä¹‰çš„ä»£ç åŒºåŸŸ</textarea>
<input type="button" onClick="copyUrl2()" value="ç‚¹å‡»å¤åˆ¶ä»£ç " />
```

äºŒã€å¤åˆ¶ä¸“é¢˜åœ°å€å’Œ url åœ°å€ï¼Œä¼ ç»™ QQ/MSN ä¸Šçš„å¥½å‹

```js
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>Jså¤åˆ¶ä»£ç </title>
</head>
<body>
<p>
<input type="button" name="anniu1" onClick='copyToClipBoard()' value="å¤åˆ¶ä¸“é¢˜åœ°å€å’Œurlåœ°å€ï¼Œä¼ ç»™QQ/MSNä¸Šçš„å¥½å‹">
<script language="javascript">
function copyToClipBoard(){
var clipBoardContent="";
clipBoardContent+=document.title;
clipBoardContent+="";
clipBoardContent+=this.location.href;
window.clipboardData.setData("Text",clipBoardContent);
alert("å¤åˆ¶æˆåŠŸï¼Œè¯·ç²˜è´´åˆ°ä½ çš„QQ/MSNä¸Šæ¨èç»™ä½ çš„å¥½å‹");
}
</script>
```

ä¸‰ã€ç›´æ¥å¤åˆ¶ url

```js
<input type="button" name="anniu2" onClick='copyUrl()' value="å¤åˆ¶URLåœ°å€">
<script language="javascript">
function copyUrl()
{
var clipBoardContent=this.location.href;
window.clipboardData.setData("Text",clipBoardContent);
alert("å¤åˆ¶æˆåŠŸ!");
}
</script>
```

å››ã€ç‚¹å‡»æ–‡æœ¬æ¡†æ—¶ï¼Œå¤åˆ¶æ–‡æœ¬æ¡†é‡Œé¢çš„å†…å®¹

```js
<input onclick="oCopy(this)" value="ä½ å¥½.è¦copyçš„å†…å®¹!">
<script language="javascript">
function oCopy(obj){
obj.select();
js=obj.createTextRange();
js.execCommand("Copy")
alert("å¤åˆ¶æˆåŠŸ!");
}
</script>
```

äº”ã€å¤åˆ¶æ–‡æœ¬æ¡†æˆ–è€…éšè—åŸŸä¸­çš„å†…å®¹

```js
<script language="javascript">
function CopyUrl(target){
target.value=myimg.value;
target.select();
js=myimg.createTextRange();
js.execCommand("Copy");
alert("å¤åˆ¶æˆåŠŸ!");
}
function AddImg(target){
target.value="[IMG]"+myimg.value+"[/ img]";
target.select();
js=target.createTextRange();
js.execCommand("Copy");
alert("å¤åˆ¶æˆåŠŸ!");
}
</script>
```

å…­ã€å¤åˆ¶ span æ ‡è®°ä¸­çš„å†…å®¹

```js
<script type="text/javascript">
</script>
<br />
<br />
<script type="text/javascript">function copyText(obj)
{
var rng = document.body.createTextRange();
rng.moveToElementText(obj);
rng.scrollIntoView();
rng.select();
rng.execCommand("Copy");
rng.collapse(false);
alert("å¤åˆ¶æˆåŠŸ!");
}
</script>
```

ä¸ƒã€æµè§ˆå™¨å…¼å®¹  copyToClipboard("æ‹·è´å†…å®¹")

```js
function copyToClipboard(txt) {
  if (window.clipboardData) {
    window.clipboardData.clearData();
    clipboardData.setData("Text", txt);
    alert("å¤åˆ¶æˆåŠŸï¼");

  } else if (navigator.userAgent.indexOf("Opera") != -1) {
    window.location = txt;
  } else if (window.netscape) {
    try {
      netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
    } catch (e) {
      alert("è¢«æµè§ˆå™¨æ‹’ç»ï¼\nè¯·åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥'about:config'å¹¶å›è½¦\nç„¶åå°† 'signed.applets.codebase_principal_support'è®¾ç½®ä¸º'true'");
    }
    var clip = Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);
    if (!clip)
      return;
    var trans = Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);
    if (!trans)
      return;
    trans.addDataFlavor("text/unicode");
    var str = new Object();
    var len = new Object();
    var str = Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);
    var copytext = txt;
    str.data = copytext;
    trans.setTransferData("text/unicode", str, copytext.length * 2);
    var clipid = Components.interfaces.nsIClipboard;
    if (!clip)
      return false;
    clip.setData(trans, null, clipid.kGlobalClipboard);
    alert("å¤åˆ¶æˆåŠŸï¼");
  }
}
```

å…«ã€å…¼å®¹å„å¤§æµè§ˆå™¨çš„å¤åˆ¶ä»£ç ï¼ˆç»“åˆ ZeroClipboard.jsï¼‰

```html
<html>
<head>
<title>Zero Clipboard Test</title>
<script type="text/javascript" src="ZeroClipboard.js"></script>
<script language="JavaScript">
 var clip = null;
 function $(id) { return document.getElementById(id); }
 function init() {
     clip = new ZeroClipboard.Client();
     clip.setHandCursor(true);    
     clip.addEventListener('mouseOver', function (client) {
  // update the text on mouse over
  clip.setText( $('fe_text').value );
     });
      
     clip.addEventListener('complete', function (client, text) {
  //debugstr("Copied text to clipboard: " + text );
  alert("è¯¥åœ°å€å·²ç»å¤åˆ¶ï¼Œä½ å¯ä»¥ä½¿ç”¨Ctrl+V ç²˜è´´ã€‚");
     });
     clip.glue('clip_button', 'clip_container' );
 }
</script>
</head>
<body onLoad="init()">
<input id="fe_text" cols=50 rows=5 value=å¤åˆ¶å†…å®¹æ–‡æœ¬1 >
<span id="clip_container"><span id="clip_button"><b>å¤åˆ¶</b></span></span>
</body>
</html
```


## share [ğŸ”](#weekly-95)

[readme](../README.md) | [previous](202412W4.md) | [next](202412W6.md)
